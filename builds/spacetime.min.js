!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).spacetime=t()}(this,(function(){"use strict";var e={am:"am",pm:"pm",seasons:{north:[["spring",2,1],["summer",5,1],["fall",8,1],["winter",11,1]],south:[["fall",2,1],["winter",5,1],["spring",8,1],["summer",11,1]]},days:{shortForm:["sun","mon","tue","wed","thu","fri","sat"],longForm:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]},weekStart:1,quarters:[[0,1],[3,1],[6,1],[9,1]],months:{shortForm:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],longForm:["january","february","march","april","may","june","july","august","september","october","november","december"]},useTitleCase:!0,fallbackTz:(()=>{if("undefined"==typeof Intl||void 0===Intl.DateTimeFormat)return null;let e=Intl.DateTimeFormat();if(void 0===e||void 0===e.resolvedOptions)return null;let t=e.resolvedOptions().timeZone;return t||null})()||"Etc/Utc",fallbackHemisphere:"n",fallbackYear:2023,preferDMY:!1,now:()=>(new Date).getTime(),minimumEpoch:25e8};var t=function(e){return e%4==0&&e%100!=0||e%400==0};const r=1e3,n=6e4,o=36e5,a=24*o,s=365*a,u=s+a;var i={};const l={},m=function(e){if(e&&i.hasOwnProperty(e)){let t=i[e],r=t.offset||0;return"s"===t.hem&&t.dst&&(r+=t.change||1),r*o}return 0},h=function(e,r){let n=function(e){if(l.hasOwnProperty(e))return l[e];let r=0;if(e>1970)for(let n=1970;n<e;n+=1)t(n)?r+=u:r+=s,l[n+1]=r;else{let n=1970;for(;n>e;)n-=1,t(n)?r-=u:r-=s,l[n]=r}return r}(e);return n-=m(r),n};let c={usa:"2nd-sun-mar-2h|1st-sun-nov-2h",mex:"1st-sun-apr-2h|last-sun-oct-2h",eu0:"last-sun-mar-0h|last-sun-oct-1h",eu1:"last-sun-mar-1h|last-sun-oct-2h",eu2:"last-sun-mar-2h|last-sun-oct-3h",eu3:"last-sun-mar-3h|last-sun-oct-4h",green:"last-sat-mar-22h|last-sat-oct-23h",aus:"1st-sun-apr-1h|1st-sun-oct-2h",lhow:"1st-sun-apr-0.5h|1st-sun-oct-2h",chat:"1st-sun-apr-2h|last-sun-sep-2h",nz:"1st-sun-apr-1h|last-sun-sep-2h",ant:"2nd-sun-mar-0h|1st-sun-oct-0h",troll:"last-sun-mar-2h|last-sun-oct-3h",jord:"last-fri-feb-0h|last-fri-oct-1h",leb:"last-sun-mar-0h|last-sun-oct-0h",syr:"last-fri-mar-0h|last-fri-oct-0h",isr:"last-fri-mar-2h|last-sun-oct-2h",pal:"last-sun-mar-0h|last-fri-oct-1h",saha:"last-sun-mar-3h|1st-sun-may-2h",par:"last-sat-mar-22h|1st-sun-oct-0h",cuba:"2nd-sun-mar-0h|1st-sun-nov-1h",chile:"1st-sat-apr-22h|1st-sun-sep-0h",east:"1st-sat-apr-20h|1st-sat-sep-22h",fiji:"3rd-sun-jan-3h|2nd-sun-nov-2h",iran:"4th-mon-march-0h|3rd-fri-sep-0h"};const d=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],f=["sun","mon","tue","wed","thu","fri","sat"],p=function(e){let[t,r,n,o]=e.split(/-/g);return o=o.replace(/h$/,""),o=Number(o),"last"!==t&&(t=t.replace(/(st|nd|rd|th)$/,""),t=Number(t)||t),n=d.indexOf(n)+1,r=f.indexOf(r),{num:t,day:r,month:n,hour:o}};Object.keys(c).forEach((e=>{let t=c[e],[r,n]=t.split(/\|/);c[e]={start:p(r),end:p(n)}}));var y=c;var g=function(e,t,r){let n=function(e){let t=e%100;return(t+parseInt(t/4,10))%7}(e),o=[null,0,3,3,6,1,4,6,2,5,0,3,5][t];let a=function(e){if(e<1752)return 18-parseInt(e/100,10)%7;let t=parseInt(e/100,10);return{17:4,18:2,19:0,20:6,21:4,22:2,23:0}[String(t)]||0}(e),s=r,u=function(e){return!0==(e%4==0&&e%100!=0||e%400==0)?-1:0}(e);return(n+o+a+s+u)%7},b=[{long:"January",short:"Jan",len:31},{long:"February",short:"Feb",len:28},{long:"March",short:"Mar",len:31},{long:"April",short:"Apr",len:30},{long:"May",short:"May",len:31},{long:"June",short:"Jun",len:30},{long:"July",short:"Jul",len:31},{long:"August",short:"Aug",len:31},{long:"September",short:"Sep",len:30},{long:"October",short:"Oct",len:31},{long:"November",short:"Nov",len:30},{long:"December",short:"Dec",len:31}];const v=b.map((e=>e.len));var $=function(e,r,n){let s=1,u=e.month,i=h(r);i+=function(e,r){let n=0;for(let o=0;o<e-1;o+=1){let e=v[o];1===o&&t(r)&&(e=29),n+=e*a}return n}(e.month,r);let l=function(e,t){let r=g(t,e.month,1),n=e.day,o=0;for(let e=0;e<7;e+=1){if(r===n)return o;r+=1,r%=7,o+=1}return 0}(e,r);return s+=l,i+=l*a,l=function(e,t,r){if("first"===e||e<=1)return 0;if("last"===e){let e=v[r+1]||31,n=0;for(let r=0;r<5;r+=1)if(n+=7,n+t>=e)return n-7;return console.log("fixme [toRightWeek]"),3}return 7*(e-1)}(e.num,l,e.month),i+=l*a,s+=l,i+=(e.hour||0)*o,i-=60*n*60*1e3,{epoch:i,month:u,date:s}};let w={};var j=function(e,t){if(w.hasOwnProperty(e)&&w[e].hasOwnProperty(t))return w[e][t];w[e]=w[e]||{};let{dst:r,offset:n,change:a,hem:s}=i[e]||{};a=a||1;let u=[],l=y[r];if(!l)return w[e][t]=[],u;let m=$(l.start,t,n),h="n"===s?a:0;return u.push({epoch:m.epoch,cal:{year:t,month:m.month,date:m.date,hour:l.start.hour,minute:0,second:0,millisecond:0},delta:h,offset:n+h}),m=$(l.end,t,n),h="s"===s?a:0,u.push({epoch:m.epoch-o,cal:{year:t,month:m.month,date:m.date,hour:l.end.hour,minute:0,second:0,millisecond:0},delta:h,offset:n+h}),w[e][t]=u,u};var O=function(e){return Object.keys(e).forEach((t=>{var r;void 0!==(r=e[t])&&Number(r)===r&&r%1!=0&&(e[t]=parseInt(e[t],10)),e[t]<0&&"year"!==t&&(e[t]=0)})),e.month=e.month||1,e.date=e.date||1,e.hour=e.hour||0,e.minute=e.minute||0,e.second=e.second||0,e.millisecond=e.millisecond||0,e.month&&e.month>12&&(e.month=12),e.date&&b[e.month]&&e.date>b[e.month].len&&(e.date=b[e.month].len),e.hour&&e.hour>24&&(e.month=24),e.minute&&e.minute>59&&(e.month=59),e.second&&e.second>59&&(e.second=59),e.millisecond&&e.millisecond>999&&(e.millisecond=999),e};var z=function(e,s,u){let i=function(e,r){let n=0;for(let o=e.month;o<r.month;o+=1)n+=b[o-1].len,2===o&&t(e.year)&&(n+=1);return n+=r.date-e.date,n}(s,u);return e+=i*a,s.month=u.month,s.date=u.date,i=u.hour-s.hour,e+=i*o,s.hour+=i,i=u.minute-s.minute,e+=i*n,s.minute+=i,i=u.second-s.second,e+=i*r,s.second+=i,i=u.millisecond-s.millisecond,e+=i,s.millisecond+=i,function(e,t){const r=["year","month","date","hour","minute","second","millisecond"];for(let n=0;n<r.length;n+=1){let o=r[n];if(e[o]!==t[o])return console.error("\n----\nMis-matched unit in walk:",o),console.error(e,"\n",t),!1}}(s,u),e};const I={month:1,date:1,hour:0,minute:0,second:0,millisecond:0};var M=function(e,t){e=O(e);let r=h(e.year,t),n=Object.assign({},I,{year:e.year}),o=j(t,e.year).reverse().find((t=>function(e,t){const r=["year","month","date","hour","minute","second","millisecond"];for(let n=0;n<r.length;n+=1){let o=r[n];if(e[o]>t[o])return!0;if(e[o]<t[o])return!1}return!0}(e,t.cal)));return o&&(r=o.epoch,n=Object.assign({},I,o.cal,{year:e.year})),r=z(r,n,e),r};b.reduce(((e,t,r)=>(e[t.long.toLowerCase()]=r+1,e[t.short.toLowerCase()]=r+1,e)),{}).sept=9;var k=function(e){return e=e.toLowerCase().trim(),b[e]};const S=/^([+-])?([0-9]{1,2}):?([0-9]{2})?$/;var T=e=>{if(!e||"Z"===e||"z"===e)return 0;let t=e.match(S);if(null!==t){let[,e,r,n]=t;r=parseInt(r||"",10)||0,n=parseInt(n||"",10)||0,n/=60;let o=r+n;return"-"===e&&(o*=-1),o}return 0};const N={hour:0,minute:0,second:0,millisecond:0};var E=(e="",t)=>{t=Object.assign({},N,t);let r=(e=e.replace(/^\s+/,"").toLowerCase()).match(/([0-9]{1,2}):([0-9]{1,2}):?([0-9]{1,2})?[:.]?([0-9]{1,4})?/);if(null!==r){let n=Number(r[1]);if(n<0||n>24)return t;let o=Number(r[2]);if(r[2].length<2||o<0||o>59)return t;t.hour=n,t.minute=o,t.second=Number(r[3])||0,t.millisecond=function(e=""){return(e=String(e)).length>3?e=e.substring(0,3):1===e.length?e+="00":2===e.length&&(e+="0"),Number(e)||0}(r[4]);let a=e.match(/[\\b0-9] ?(am|pm)\b/);return null!==a&&"pm"===a[1]&&(t.hour+=12),t}if(r=e.match(/([0-9]+) ?(am|pm)/),null!==r&&r[1]){let e=Number(r[1]);return e>12||e<1||(t.hour=r[1]||0,"pm"===r[2]&&(t.hour+=12)),t}return t};var F=(e="")=>{if(e=e.trim(),!0===/^'[0-9][0-9]$/.test(e)){let t=Number(e.replace(/'/,""));return t>50?1900+t:2e3+t}return parseInt(e,10)};var A=(e="")=>(e=(e=(e=e.trim()).replace(/^0+/,"")).replace(/([0-9])(st|nd|rd|th)$/i,"$1"),parseInt(e,10)||1),C=[].concat([{reg:/^(-?0{0,2}[0-9]{3,4})-([0-9]{1,2})-([0-9]{1,2})[T| ]([0-9.:]+)(Z|[0-9\-+:]+)?$/i,parse:e=>{let t={year:F(e[1]),month:parseInt(e[2],10),date:A(e[3])};return t.offset=T(e[5]),t=E(e[4],t),t}},{reg:/^([0-9]{4})[-/. ]([0-9]{1,2})[-/. ]([0-9]{1,2})( [0-9]{1,2}(:[0-9]{0,2})?(:[0-9]{0,3})? ?(am|pm)?)?$/i,parse:e=>{let t={year:F(e[1]),month:parseInt(e[2],10),date:A(e[3])};return t.month>=12&&(t.date=A(e[2]),t.month=parseInt(e[3],10)),t=E(e[4],t),t}},{reg:/^([0-9]{4})[-/. ]([a-z]+)[-/. ]([0-9]{1,2})( [0-9]{1,2}(:[0-9]{0,2})?(:[0-9]{0,3})? ?(am|pm)?)?$/i,parse:e=>{let t={year:F(e[1]),month:k(e[2]),date:A(e[3]||"")};return t=E(e[4],t),t}}],[{reg:/^([0-9]{1,2})[-/.]([0-9]{1,2})[-/.]?([0-9]{4})?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2} ?(am|pm|gmt))?$/i,parse:e=>{let t=parseInt(e[1],10);return{date:A(e[2]),month:t,year:F(e[3])}}},{reg:/^([a-z]+)[\-/. ]([0-9]{1,2})[\-/. ]?([0-9]{4}|'[0-9]{2})?( [0-9]{1,2}(:[0-9]{0,2})?(:[0-9]{0,3})? ?(am|pm)?)?$/i,parse:e=>{let t={year:F(e[3]),month:k(e[1]),date:A(e[2]||"")};return t=E(e[4],t),t}},{reg:/^([a-z]+) ([0-9]{1,2})( [0-9]{4})?( ([0-9:]+( ?am| ?pm| ?gmt)?))?$/i,parse:e=>{let t={year:F(e[3]),month:k(e[1]),date:A(e[2]||"")};return t=E(e[4],t),t}},{reg:/^([a-z]+) ([0-9]{1,2})( [0-9:]+)?( \+[0-9]{4})?( [0-9]{4})?$/i,parse:e=>{let t={year:F(e[5]),month:k(e[1]),date:A(e[2]||"")};return t=E(e[4],t),t}}],[{reg:/^([0-9]{1,2})[-/]([a-z]+)[-/]?([0-9]{4})?$/i,parse:e=>{let t={year:F(e[3]),month:k(e[2]),date:A(e[1]||"")};return t=E(e[4],t),t}},{reg:/^([0-9]{1,2})( [a-z]+)( [0-9]{4}| '[0-9]{2})? ?([0-9]{1,2}:[0-9]{2}:?[0-9]{0,2} ?(am|pm|gmt))?$/i,parse:e=>{let t={year:F(e[3]),month:k(e[2]),date:A(e[1])};return t=E(e[4],t),t}},{reg:/^([0-9]{1,2})[ /]([a-z]+)[ /]([0-9]{4})?( [0-9]{1,2}(:[0-9]{0,2})?(:[0-9]{0,3})? ?(am|pm)?)?$/i,parse:e=>{let t={date:A(e[1]),month:k(e[2]),year:F(e[3])};return t=E(e[4],t),t}}],[{reg:/^([0-9]{4})[-/]([0-9]{2})$/,parse:e=>({year:F(e[1]),month:parseInt(e[2],10)})},{reg:/^([a-z]+) ([0-9]{4})$/i,parse:e=>({year:F(e[2]),month:k(e[1])})},{reg:/^(q[0-9])( of)?( [0-9]{4})?/i,parse:e=>{if(e[1],e[3]){return{year:F(e[3])}}return{}}},{reg:/^(spring|summer|winter|fall|autumn)( of)?( [0-9]{4})?/i,parse:e=>{if(e[1],e[3]){return{year:F(e[3])}}return{}}},{reg:/^[0-9,]+ ?b\.?c\.?$/i,parse:e=>{let t=e[0]||"";return t=t.replace(/^([0-9,]+) ?b\.?c\.?$/i,"-$1"),{year:parseInt(t.trim(),10)}}},{reg:/^[0-9,]+ ?(a\.?d\.?|c\.?e\.?)$/i,parse:e=>{let t=e[0]||"";return t=t.replace(/,/g,""),{year:parseInt(t.trim(),10)}}},{reg:/^[0-9]{4}( ?a\.?d\.?)?$/i,parse:e=>({year:F(e[0])})}]);var P=function(e,t){for(let t=0;t<C.length;t+=1){let r=e.match(C[t].reg);if(null!==r){return C[t].parse(r)}}return{}};const D=["year","month","date","hour","minute","second","millisecond"];var x=function(t,r){if(null==t)return e.now();if("number"==typeof(n=t)&&isFinite(n))return t<e.minimumEpoch&&t>0&&(t*=1e3),t;var n,o;if(o=t,"[object Array]"===Object.prototype.toString.call(o)){let e=D.reduce(((e,r,n)=>(e[r]=t[n],e)),{});return M(e,r)}if((e=>"[object Object]"===Object.prototype.toString.call(e))(t)){let e=Object.assign({},t);return M(e,r)}if((e=>"string"==typeof e)(t)){let e=P(t);return M(e,r)}return null};const J=b.map((e=>e.len));var L=function(e,l){let{start:h,year:c}=function(e,r){let n=0;n-=m(r);let o=1970;if(e>-1728e5)for(;n<=e;){let r=s;t(o)&&(r=u);let a=n+r;if(a>e)break;n=a,o+=1}else for(;n>e;){let e=s;t(o)&&(e=u),n-=e,o-=1}return{start:n,year:o}}(e,l),d={year:c,month:1,date:1,hour:0,second:0,millisecond:0,offset:(i[l]||{}).offset||0},f=j(l,c);for(let t=f.length-1;t>=0;t-=1)if(e>=f[t].epoch){d.offset=f[t].offset,e+=f[t].delta*o;break}let p=e-h,y=Math.floor(p/a),g=function(e,r){let n={month:1,date:1},o=0;for(let a=0;a<b.length-1;a+=1){let s=J[a];if(1===a&&t(r)&&(s=29),o+s>e)break;o+=s,n.month+=1}return n.date+=e-o,n}(y,c);Object.assign(d,g);let v=function(e){let t={hour:0,minute:0,second:0,ms:0};return t.hour=Math.floor(e/o),e-=t.hour*o,t.minute=Math.floor(e/n),e-=t.minute*n,t.second=Math.floor(e/r),e-=t.second*r,t.ms=e,t}(p-y*a);return Object.assign(d,v),d},Q={year:(e,t)=>L(e,t).year,month:(e,t)=>L(e,t).month,date:(e,t)=>L(e,t).date,hour:(e,t)=>L(e,t).hour,minute:(e,t)=>L(e,t).minute,second:(e,t)=>L(e,t).second,ampm:(e,t)=>L(e,t).hour<12?"am":"pm"},q={year:(e,t,r)=>new _(e,t)};function Z(e){let t=e%10,r=e%100;return 1===t&&11!==r?e+"st":2===t&&12!==r?e+"nd":3===t&&13!==r?e+"rd":e+"th"}function B(e,t=2){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}const Y={date:e=>e.date,"date-ordinal":e=>Z(e.date),"date-pad":e=>B(e.date),"month-number":e=>e.month,"month-ordinal":e=>Z(e.month),"month-pad":e=>B(e.month),"iso-month":e=>B(e.month+1),"iso-short":e=>`${e.year}-${B(e.month)}-${B(e.date)}`,iso:e=>`${e.year}-${B(e.month)}-${B(e.date)}T${B(e.hour)}:${B(e.minute)}:${B(e.second)}.${B(e.ms,3)}`,year:e=>e.year>0?e.year:`${Math.abs(e.year)} BC`,"year-short":e=>{let t=e.year;return t>0?`'${String(t).substr(2,4)}`:Math.abs(t)+" BC"},"iso-year":e=>{let t=B(Math.abs(e.year),4);return e.year<0&&(t="-"+B(t,6)),t},time:e=>e.time(),"time-24":e=>`${e.hour}:${B(e.minute)}`,hour:e=>e.hour%12,"hour-pad":e=>B(e.hour%12),"hour-24":e=>e.hour,"hour-24-pad":e=>B(e.hour),minute:e=>e.minute,"minute-pad":e=>B(e.minute),second:e=>e.second,"second-pad":e=>B(e.second),ms:e=>e.ms,millisecond:e=>e.ms,"millisecond-pad":e=>B(e.ms,3),ampm:e=>e.hour<12?"am":"pm",AMPM:e=>e.hour<12?"AM":"PM",quarter:e=>e.month<3?"Q1":e.month<6?"Q2":e.month<9?"Q3":"Q4",offset:e=>{let t=e.offset||0,r=t<=0?"-":"+";t=Math.abs(t);let n=parseInt(t,10);r+=String(n).padStart(2,"0");let o=t%1;if(o){r+=":"+String(60*o).padStart(2,"0")}else r+=":00";return r}},H={"hour-12":"hour","hour-12-pad":"hour-pad","day-name":"day","month-name":"month","iso 8601":"iso","time-h24":"time-24","time-12":"time","time-h12":"time",tz:"timezone","day-num":"day-number","month-num":"month-number","month-iso":"iso-month","year-iso":"iso-year","nice-short":"nice","nice-short-24":"nice-24",mdy:"numeric-us",dmy:"numeric-uk",ymd:"numeric","yyyy/mm/dd":"numeric","mm/dd/yyyy":"numeric-us","dd/mm/yyyy":"numeric-us","little-endian":"numeric-uk","big-endian":"numeric","day-nice":"nice-day"};Object.keys(H).forEach((e=>Y[e]=Y[H[e]]));var R=Y;var U=function(e,t){return t=t.replace(/\{(.+?)\}/g,((t,r)=>(r=r.toLowerCase().trim(),R.hasOwnProperty(r)?R[r](e):`{${r}}`)))};let W={format:function(e){let t=L(this.epoch,this.tz);return e&&R.hasOwnProperty(e)?R[e](t):U(t,e)}};[["iso","{iso-year}-{month-pad}-{date-pad}T{hour-24-pad}:{minute-pad}:{second-pad}.{millisecond-pad}{offset}"],["time","{hour-12}:{minute-pad}{ampm}"]].forEach((e=>{let[t,r]=e;W[t]=function(){let e=L(this.epoch,this.tz);return U(e,r)}}));var G=W;let K={};["year","month","date","hour","minute","second"].forEach((e=>{K[e]=function(t){let{epoch:r,tz:n}=this;return void 0!==t?q[e](r,n,t):Q[e](r,n)}})),Object.assign(K,G);var V=K;const X=function(t,r){this.tz=r||e.fallbackTz,this.epoch=x(t,this.tz)};Object.assign(X.prototype,V);[["hours","hour"],["minutes","minute"],["seconds","second"]].forEach((e=>{X.prototype[e[0]]=X.prototype[e[1]]}));var _=X;const ee=(e,t)=>new _(e,t);return ee.now=t=>new _(e.now(),t),ee.today=e=>new _((new Date).getTime(),e).startOf("day"),ee}));
